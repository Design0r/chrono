import{c as B,b as U,r as V,d as W,j as s,C as X,k as Z,q as ee,e as te,E as se}from"./index-7IYTYZSB.js";import{a as ne}from"./LoadingSpinner-DcRd7ctl.js";function re(n){const e=B.c(66),{request:t}=n,c=new Date(t.start_date),h=new Date(t.end_date),{addToast:i,addErrorToast:b}=U();let l;e[0]===Symbol.for("react.memo_cache_sentinel")?(l=new X,e[0]=l):l=e[0];const d=l,[a,u]=V.useState(!0),[r,m]=V.useState(!1);let o;e[1]!==t.request.request_id?(o=["requests",t.request.request_id],e[1]=t.request.request_id,e[2]=o):o=e[2];let f;e[3]!==t.end_date||e[4]!==t.request.user_id||e[5]!==t.start_date?(f=x=>{const{state:Q,reason:O}=x;return d.requests.patchRequest({userId:t.request.user_id,state:Q,reason:O,start_date:t.start_date,end_date:t.end_date})},e[3]=t.end_date,e[4]=t.request.user_id,e[5]=t.start_date,e[6]=f):f=e[6];let j;e[7]!==i||e[8]!==t.request.name||e[9]!==t.request.username?(j=(x,Q)=>{i(`${Z(Q.state)} request ${t.request.name} from ${t.request.username}`,"success"),u(!1)},e[7]=i,e[8]=t.request.name,e[9]=t.request.username,e[10]=j):j=e[10];let q;e[11]!==b?(q=x=>b(x),e[11]=b,e[12]=q):q=e[12];let T;e[13]!==o||e[14]!==f||e[15]!==j||e[16]!==q?(T={mutationKey:o,mutationFn:f,onSuccess:j,onError:q},e[13]=o,e[14]=f,e[15]=j,e[16]=q,e[17]=T):T=e[17];const _=W(T);if(!a){let x;return e[18]===Symbol.for("react.memo_cache_sentinel")?(x=s.jsx(s.Fragment,{}),e[18]=x):x=e[18],x}let p;e[19]!==r||e[20]!==_||e[21]!==t.request.message||e[22]!==m?(p=r&&s.jsx(le,{onClose:()=>m(!1),onDecline:x=>_.mutate(x),message:t.request.message}),e[19]=r,e[20]=_,e[21]=t.request.message,e[22]=m,e[23]=p):p=e[23];const G="hover:bg-primary/10 pt-8 border-b-1 border-primary/25 text-base-content/80 hover:text-primary animate-color";let g;e[24]!==t.request.request_id?(g=s.jsx("td",{children:t.request.request_id}),e[24]=t.request.request_id,e[25]=g):g=e[25];let y;e[26]!==t.request.username?(y=s.jsx("td",{children:t.request.username}),e[26]=t.request.username,e[27]=y):y=e[27];let N;e[28]!==t.request.name?(N=s.jsx("td",{children:t.request.name}),e[28]=t.request.name,e[29]=N):N=e[29];const z=t.event_count>1?"days":"day";let v;e[30]!==z?(v=s.jsx("span",{className:"opacity-40 px-1",children:z}),e[30]=z,e[31]=v):v=e[31];let D;e[32]!==t.event_count||e[33]!==v?(D=s.jsxs("td",{children:[t.event_count," ",v]}),e[32]=t.event_count,e[33]=v,e[34]=D):D=e[34];const P=c.getDate(),I=c.getMonth()+1,K=c.getFullYear();let S;e[35]!==P||e[36]!==I||e[37]!==K?(S=s.jsxs("td",{children:[P,".",I,".",K]}),e[35]=P,e[36]=I,e[37]=K,e[38]=S):S=e[38];const Y=h.getDate(),H=".",A=h.getMonth()+1,J=".",L=h.getFullYear();let C;e[39]!==Y||e[40]!==A||e[41]!==L?(C=s.jsxs("td",{children:[Y,H,A,J,L]}),e[39]=Y,e[40]=A,e[41]=L,e[42]=C):C=e[42];let E;e[43]!==t.conflicts?(E=t.conflicts&&s.jsx("div",{className:"flex flex-wrap space-x-2 space-y-2",children:t.conflicts.map(ae)}),e[43]=t.conflicts,e[44]=E):E=e[44];let R;e[45]!==E?(R=s.jsx("td",{className:"align-middle",children:E}),e[45]=E,e[46]=R):R=e[46];let w;e[47]!==_?(w=s.jsx("button",{onClick:()=>_.mutate({state:"accepted",reason:""}),className:"btn btn-soft btn-sm btn-primary icon-outlined animate-color",children:"check"}),e[47]=_,e[48]=w):w=e[48];let k;e[49]!==m?(k=s.jsx("button",{onClick:()=>m(!0),className:"btn btn-soft btn-sm btn-error icon-outlined animate-color",children:"close"}),e[49]=m,e[50]=k):k=e[50];let $;e[51]!==w||e[52]!==k?($=s.jsxs("td",{className:"flex justify-center align-middle gap-2",children:[w,k]}),e[51]=w,e[52]=k,e[53]=$):$=e[53];let F;e[54]!==y||e[55]!==N||e[56]!==D||e[57]!==S||e[58]!==C||e[59]!==R||e[60]!==$||e[61]!==g?(F=s.jsxs("tr",{className:G,children:[g,y,N,D,S,C,R,$]}),e[54]=y,e[55]=N,e[56]=D,e[57]=S,e[58]=C,e[59]=R,e[60]=$,e[61]=g,e[62]=F):F=e[62];let M;return e[63]!==F||e[64]!==p?(M=s.jsxs(s.Fragment,{children:[p,F]}),e[63]=F,e[64]=p,e[65]=M):M=e[65],M}function ae(n){return s.jsx("span",{className:"badge badge-soft badge-info badge-sm cursor-default hover:text-white/60 hover:bg-info/20 animate-color",children:n.username})}function le(n){const e=B.c(15),{message:t,onClose:c,onDecline:h}=n,[i,b]=V.useState("");let l;e[0]!==c?(l=s.jsx("button",{onClick:c,className:"absolute cursor-pointer right-3 top-3 icon-outlined items-end text-xl justify-end",children:"close"}),e[0]=c,e[1]=l):l=e[1];let d;e[2]===Symbol.for("react.memo_cache_sentinel")?(d=s.jsx("h1",{className:"text-xl font-bold",children:"Reject Requeust"}),e[2]=d):d=e[2];let a;e[3]!==t?(a=t&&s.jsx("h4",{children:t}),e[3]=t,e[4]=a):a=e[4];let u,r,m;e[5]===Symbol.for("react.memo_cache_sentinel")?(u=s.jsx("h5",{children:"Reject Reason"}),r=s.jsx("textarea",{onChange:j=>b(j.target.value),className:"textarea w-full text-white textarea-bordered"}),m=s.jsx("br",{}),e[5]=u,e[6]=r,e[7]=m):(u=e[5],r=e[6],m=e[7]);let o;e[8]!==h||e[9]!==i?(o=s.jsxs("div",{className:"modal-backdrop",children:[u,r,m,s.jsx("button",{id:"reject-btn",className:"btn btn-error text-xl animate-color",onClick:()=>h({state:"declined",reason:i}),children:"Decline"})]}),e[8]=h,e[9]=i,e[10]=o):o=e[10];let f;return e[11]!==l||e[12]!==a||e[13]!==o?(f=s.jsx("div",{className:"fixed z-10 inset-0 bg-opacity-50 backdrop-blur-md flex items-center justify-center",children:s.jsx("dialog",{className:"modal modal-open",children:s.jsxs("div",{className:"modal-box",children:[l,d,a,o]})})}),e[11]=l,e[12]=a,e[13]=o,e[14]=f):f=e[14],f}function de(){const n=B.c(11),{chrono:e}=ee.useRouteContext();let t;n[0]===Symbol.for("react.memo_cache_sentinel")?(t=["requests"],n[0]=t):t=n[0];let c;n[1]!==e?(c={queryKey:t,queryFn:()=>e.requests.getRequests()},n[1]=e,n[2]=c):c=n[2];const{isPending:h,data:i,error:b,isError:l}=te(c);if(l){let r;return n[3]!==b?(r=s.jsx(se,{error:b}),n[3]=b,n[4]=r):r=n[4],r}if(h){let r;return n[5]===Symbol.for("react.memo_cache_sentinel")?(r=s.jsx(ne,{}),n[5]=r):r=n[5],r}let d;n[6]===Symbol.for("react.memo_cache_sentinel")?(d=s.jsx("thead",{children:s.jsxs("tr",{className:"bg-base-200 text-base-content border-b-1.5 border-primary/65",children:[s.jsx("th",{children:"ID"}),s.jsx("th",{children:"Name"}),s.jsx("th",{children:"Event Type"}),s.jsx("th",{children:"Number of Days"}),s.jsx("th",{children:"Event Start Date"}),s.jsx("th",{children:"Event End Date"}),s.jsx("th",{children:"Conflicts"}),s.jsx("th",{className:"text-center",children:"Actions"})]})}),n[6]=d):d=n[6];let a;n[7]!==i?(a=i.map(oe),n[7]=i,n[8]=a):a=n[8];let u;return n[9]!==a?(u=s.jsx("div",{className:"p-2 my-2",children:s.jsx("div",{className:"overflow-x-auto bg-info/3",children:s.jsxs("table",{className:"table table-zebra table-md ",children:[d,s.jsx("tbody",{children:a})]})})}),n[9]=a,n[10]=u):u=n[10],u}function oe(n){return s.jsx(re,{request:n},n.request.request_id)}export{de as component};
