import{j as s,c as te,g as ye,R as ge,b as ve,e as xe,r as ue,E as je}from"./index-BSHNpg02.js";import{L as _e,a as be}from"./LoadingSpinner-C7sRGP0z.js";import{d as he}from"./dayjs.min-Cfr4waKo.js";function fe({children:e}){return s.jsx("div",{className:"stats bg-base-100 max-lg:stats-vertical grid grid-cols-2 grid-rows-2 lg:grid-rows-1 lg:grid-cols-4 w-full",children:e&&(Array.isArray(e)?s.jsxs(s.Fragment,{children:[...e]}):s.jsx(s.Fragment,{children:e}))})}function j(e){const t=te.c(14),{title:i,stat:o,statClassName:p,subtitle:u,skeleton:y,children:a}=e,r=p===void 0?"-mb-1 pt-1.5 stat-value max-sm:text-2xl text-primary":p,m=`stat ${(y===void 0?!1:y)&&"skeleton"}`;let d;t[0]===Symbol.for("react.memo_cache_sentinel")?(d=s.jsx("div",{className:"stat-figure"}),t[0]=d):d=t[0];let l;t[1]!==i?(l=s.jsx("div",{className:"stat-title truncate text-accent/75 text-base ",children:i}),t[1]=i,t[2]=l):l=t[2];let x;t[3]!==a||t[4]!==o||t[5]!==r?(x=a?s.jsx(s.Fragment,{children:a}):s.jsx("div",{className:r,children:o}),t[3]=a,t[4]=o,t[5]=r,t[6]=x):x=t[6];let f;t[7]!==u?(f=s.jsx("div",{className:"stat-desc text-accent/30",children:u}),t[7]=u,t[8]=f):f=t[8];let n;return t[9]!==m||t[10]!==l||t[11]!==x||t[12]!==f?(n=s.jsxs("div",{className:m,children:[d,l,x,f]}),t[9]=m,t[10]=l,t[11]=x,t[12]=f,t[13]=n):n=t[13],n}function Z({children:e,title:t}){return s.jsxs("div",{className:"overflow-hidden my-4 p-3 rounded-xl flex flex-col items-left justify-center",children:[s.jsx("h1",{className:"text-xl",children:t}),s.jsx("div",{className:"border-b border-primary/25 mt-2 mb-8"}),e&&(Array.isArray(e)?s.jsxs("div",{children:[...e]}):s.jsx("div",{children:e}))]})}var ee={exports:{}},Ne=ee.exports,pe;function ke(){return pe||(pe=1,(function(e,t){(function(i,o){e.exports=o()})(Ne,(function(){var i="day";return function(o,p,u){var y=function(c){return c.add(4-c.isoWeekday(),i)},a=p.prototype;a.isoWeekYear=function(){return y(this).year()},a.isoWeek=function(c){if(!this.$utils().u(c))return this.add(7*(c-this.isoWeek()),i);var m,d,l,x,f=y(this),n=(m=this.isoWeekYear(),d=this.$u,l=(d?u.utc:u)().year(m).startOf("year"),x=4-l.isoWeekday(),l.isoWeekday()>4&&(x+=7),l.add(x,i));return f.diff(n,"week")+1},a.isoWeekday=function(c){return this.$utils().u(c)?this.day()||7:this.day(this.day()%7?c:c-7)};var r=a.startOf;a.startOf=function(c,m){var d=this.$utils(),l=!!d.u(m)||m;return d.p(c)==="isoweek"?l?this.date(this.date()-(this.isoWeekday()-1)).startOf("day"):this.date(this.date()-1-(this.isoWeekday()-1)+7).endOf("day"):r.bind(this)(c,m)}}}))})(ee)),ee.exports}var we=ke();const $e=ye(we);function Fe(e,t,i){return e<t?t:e>i?i:e}he.extend($e);function We(e){const t=te.c(22),{day:i}=e;let o;t[0]===Symbol.for("react.memo_cache_sentinel")?(o=["#313745","#a7f3d0","#6ee7b7","#34d399","#10b981","#059669","#047857","#065f46","#064e3b"],t[0]=o):o=t[0];const p=o;let u;t[1]!==i.count||t[2]!==i.is_holiday?(u=i.is_holiday?"#7C85FF":p[Fe(i.count,0,8)],t[1]=i.count,t[2]=i.is_holiday,t[3]=u):u=t[3];const y=u;let a;t[4]!==i.date?(a=s.jsx("div",{children:i.date}),t[4]=i.date,t[5]=a):a=t[5];let r;t[6]!==i.count?(r=s.jsxs("div",{children:["Count: ",i.count]}),t[6]=i.count,t[7]=r):r=t[7];let c;t[8]!==i.usernames?(c=i.usernames?.map(Ee),t[8]=i.usernames,t[9]=c):c=t[9];let m;t[10]!==c?(m=s.jsx(s.Fragment,{children:c}),t[10]=c,t[11]=m):m=t[11];let d;t[12]!==a||t[13]!==r||t[14]!==m?(d=s.jsxs("div",{className:"tooltip-content",children:[a,r,m]}),t[12]=a,t[13]=r,t[14]=m,t[15]=d):d=t[15];let l;t[16]!==y||t[17]!==i.last_day_of_month?(l=s.jsx("div",{className:"w-4 h-4 rounded-full",style:i.last_day_of_month?{boxShadow:"0 1.5rem 0 -0.25rem white",backgroundColor:y}:{backgroundColor:y}}),t[16]=y,t[17]=i.last_day_of_month,t[18]=l):l=t[18];let x;return t[19]!==d||t[20]!==l?(x=s.jsxs("div",{className:"tooltip",children:[d,l]}),t[19]=d,t[20]=l,t[21]=x):x=t[21],x}function Ee(e,t){return s.jsx("p",{children:e},t)}function Se(e){const t=te.c(24),{gaps:i,yearOffset:o,data:p}=e;let u;t[0]===Symbol.for("react.memo_cache_sentinel")?(u=he().isoWeek(),t[0]=u):u=t[0];const y=u;let a=1,r;if(t[1]!==i||t[2]!==a){r=[];for(const g of i){r.push(a);for(let k=0;k<g;k++)a++,r.push(a);a++}t[1]=i,t[2]=a,t[3]=r}else r=t[3];const c=r;let m;t[4]===Symbol.for("react.memo_cache_sentinel")?(m=s.jsx("div",{className:"col-span-1"}),t[4]=m):m=t[4];let d;t[5]!==i?(d=i.map(De),t[5]=i,t[6]=d):d=t[6];let l;t[7]!==d?(l=s.jsx("div",{className:"col-span-11 grid grid-rows-1 grid-flow-col h-10 gap-1 text-secondary/70",children:d}),t[7]=d,t[8]=l):l=t[8];let x;t[9]===Symbol.for("react.memo_cache_sentinel")?(x=s.jsx("div",{className:"col-span-1"}),t[9]=x):x=t[9];let f;t[10]!==c?(f=s.jsx("div",{className:"col-span-11 grid grid-rows-1 grid-flow-col h-10 gap-1 text-sm text-base-content/40",children:c.map(g=>s.jsx("p",{className:`w-4 h-4 text-center ${y===g?"text-primary font-bold":"font-light text-secondary/60"}`,children:g},g))}),t[10]=c,t[11]=f):f=t[11];let n;t[12]===Symbol.for("react.memo_cache_sentinel")?(n=s.jsxs("div",{className:"col-span-1 grid grid-rows-7 text-secondary/60 text-sm",children:[s.jsx("p",{className:"truncate",children:"Montag"}),s.jsx("p",{className:"truncate",children:"Dienstag"}),s.jsx("p",{className:"truncate",children:"Mittwoch"}),s.jsx("p",{className:"truncate",children:"Donnerstag"}),s.jsx("p",{className:"truncate",children:"Freitag"}),s.jsx("p",{className:"opacity-50 truncate",children:"Samstag"}),s.jsx("p",{className:"opacity-50 truncate",children:"Sonntag"})]}),t[12]=n):n=t[12];let h;t[13]!==o?(h=Array.from({length:o}).map(Te),t[13]=o,t[14]=h):h=t[14];let v;t[15]!==p?(v=p.map(Pe),t[15]=p,t[16]=v):v=t[16];let _;t[17]!==h||t[18]!==v?(_=s.jsx("div",{className:"col-span-11 grid grid-rows-7 h-80 grid-flow-col gap-1",children:s.jsxs("div",{className:"contents",children:[h,v]})}),t[17]=h,t[18]=v,t[19]=_):_=t[19];let b;return t[20]!==_||t[21]!==l||t[22]!==f?(b=s.jsxs("div",{className:"grid grid-cols-12 p-5 bg-base-100 rounded-2xl  xl:overflow-x-hidden overflow-x-auto mb-12",children:[m,l,x,f,n,_]}),t[20]=_,t[21]=l,t[22]=f,t[23]=b):b=t[23],b}function Pe(e,t){return s.jsx(We,{day:e},t)}function Te(e,t){return s.jsx("p",{},`yo-${t}`)}function De(e,t){return s.jsxs("div",{className:"contents",children:[s.jsxs("p",{className:"h-4 w-4 text-center",children:[t+1,"."]}),Array.from({length:e}).map((i,o)=>s.jsx("p",{className:"w-4 h-4 -z-10"},`top-gap-${t}-${o}`))]},`top-${t}`)}function Oe(e){return e%4===0&&e%100>0||e%400==0?366:365}function Ye(){var e=new Date,t=new Date(e.getFullYear(),0,0),i=e-t+(t.getTimezoneOffset()-e.getTimezoneOffset())*60*1e3,o=1e3*60*60*24,p=Math.floor(i/o);return p}function Ie(){const e=te.c(85),{chrono:t,auth:i}=ge.useRouteContext(),o=new Date().getFullYear(),{addErrorToast:p}=ve(),u=xe({queryKey:["user",i.userId,"vacation",o],queryFn:()=>t.users.getUserById(i.userId,{year:o}),staleTime:216e5,gcTime:252e5,retry:!1}),y=xe({queryKey:["vacationGraph"],queryFn:()=>t.events.getVacationGraph(o),staleTime:6e4,gcTime:18e5,retry:!1}),a=xe({queryKey:["awork",o],queryFn:()=>t.awork.getWorkTimesforYear(o),staleTime:36e5,gcTime:72e5,retry:!1}),[r,c]=ue.useState(),m=[u,y],d=m.some(qe),l=m.find(Ce)?.error;let x;e[0]!==p||e[1]!==a.data||e[2]!==a.error||e[3]!==a.isError||e[4]!==a.isPending?(x=()=>{if(a.isError){p(a.error);return}a.isPending||c(a.data)},e[0]=p,e[1]=a.data,e[2]=a.error,e[3]=a.isError,e[4]=a.isPending,e[5]=x):x=e[5];let f;if(e[6]!==a.data||e[7]!==a.isError||e[8]!==a.isPending?(f=[a.isError,a.isPending,a.data],e[6]=a.data,e[7]=a.isError,e[8]=a.isPending,e[9]=f):f=e[9],ue.useEffect(x,f),d){let N;return e[10]===Symbol.for("react.memo_cache_sentinel")?(N=s.jsx(be,{}),e[10]=N):N=e[10],N}if(l){let N;return e[11]!==l?(N=s.jsx(je,{error:l}),e[11]=l,e[12]=N):N=e[12],N}const n=u.data,h=y.data,v=Oe(o),_=Ye(),b=n.vacation_remaining/n.vacation_days*100,g=_/v*100,k=n.vacation_remaining>n.vacation_days?n.vacation_used/(n.vacation_used+n.vacation_remaining)*100:100-b,H=r?r.expected-r.worked:0;let K;e[13]===Symbol.for("react.memo_cache_sentinel")?(K=s.jsx("span",{className:"animate-pulse font-medium text-white pr-1",children:" Hej "}),e[13]=K):K=e[13];const se=n?.username;let w;e[14]!==se?(w=s.jsxs("div",{className:"text-[48px] pl-2 text-primary font-light mb-2",children:[K,se]}),e[14]=se,e[15]=w):w=e[15];let L;e[16]!==b?(L=b.toFixed(2),e[16]=b,e[17]=L):L=e[17];const ae=`${L}% remaining`;let $;e[18]!==n.vacation_remaining?($=s.jsxs("span",{className:"-mb-1 pt-1.5 stat-value max-sm:text-2xl text-primary",children:[n.vacation_remaining," d"]}),e[18]=n.vacation_remaining,e[19]=$):$=e[19];let F;e[20]!==ae||e[21]!==$?(F=s.jsx(j,{title:"Vacation remaining",subtitle:ae,children:$}),e[20]=ae,e[21]=$,e[22]=F):F=e[22];let M;e[23]!==k?(M=k.toFixed(2),e[23]=k,e[24]=M):M=e[24];const ie=`${M}% taken`;let W;e[25]!==n.vacation_used?(W=s.jsxs("span",{className:"-mb-1 pt-1.5 stat-value max-sm:text-2xl text-secondary opacity-40",children:[n.vacation_used," d"]}),e[25]=n.vacation_used,e[26]=W):W=e[26];let E;e[27]!==ie||e[28]!==W?(E=s.jsx(j,{title:"Vacation taken",subtitle:ie,children:W}),e[27]=ie,e[28]=W,e[29]=E):E=e[29];const ne=`${n.vacation_days} days total`;let S;e[30]!==n.vacation_days?(S=s.jsxs("span",{className:"-mb-1 pt-1.5 stat-value max-sm:text-2xl text-secondary opacity-40",children:[n.vacation_days," d"]}),e[30]=n.vacation_days,e[31]=S):S=e[31];let P;e[32]!==ne||e[33]!==S?(P=s.jsx(j,{title:"Vacation total",subtitle:ne,children:S}),e[32]=ne,e[33]=S,e[34]=P):P=e[34];const re=`${n.pending_events} event${n.pending_events>1?"s":""} pending`;let T;e[35]!==n.pending_events?(T=s.jsxs("span",{className:"-mb-1 pt-1.5 stat-value max-sm:text-2xl text-accent",children:[s.jsx("span",{className:"animate-pulse text-primary",children:n.pending_events})," ","d"]}),e[35]=n.pending_events,e[36]=T):T=e[36];let D;e[37]!==re||e[38]!==T?(D=s.jsx(j,{title:"Vacation pending",subtitle:re,children:T}),e[37]=re,e[38]=T,e[39]=D):D=e[39];let O;e[40]!==E||e[41]!==P||e[42]!==D||e[43]!==F?(O=s.jsx(Z,{title:"Your vacation",children:s.jsxs(fe,{children:[F,E,P,D]})}),e[40]=E,e[41]=P,e[42]=D,e[43]=F,e[44]=O):O=e[44];let Y;e[45]!==r||e[46]!==a.isPending||e[47]!==H?(Y=s.jsx(Z,{title:"Your worktimes",children:a.isPending?s.jsx("div",{className:"skeleton h-30 flex justify-center w-full",children:s.jsx(_e,{})}):s.jsx(s.Fragment,{children:r&&s.jsx(s.Fragment,{children:s.jsxs(fe,{children:[s.jsx(j,{title:"Work done this year",subtitle:`${H.toFixed(2)} h ${H>0?"remaining":"over"}`,children:s.jsxs("span",{className:"-mb-1 pt-1.5 stat-value max-sm:text-2xl text-primary",children:[r.worked.toFixed(2)," h"]})}),s.jsx(j,{title:"Expected work",subtitle:`${(r.expected/8).toFixed(2)} days`,children:s.jsxs("span",{className:"-mb-1 pt-1.5 stat-value max-sm:text-2xl text-accent",children:[r.expected," h"]})}),s.jsx(j,{title:"Vacation taken",subtitle:`${(r.vacation/8).toFixed(2)} days`,children:s.jsxs("span",{className:"-mb-1 pt-1.5 stat-value max-sm:text-2xl text-secondary opacity-40",children:[r.vacation," h"]})}),s.jsx(j,{title:"Holidays",subtitle:`${(r.holidays/8).toFixed(2)} days`,children:s.jsxs("span",{className:"-mb-1 pt-1.5 stat-value max-sm:text-2xl text-secondary opacity-40",children:[r.holidays," h"]})})]})})})}),e[45]=r,e[46]=a.isPending,e[47]=H,e[48]=Y):Y=e[48];const le=`${v} days total`;let C;e[49]!==v?(C=s.jsxs("span",{className:"-mb-1 pt-1.5 stat-value max-sm:text-2xl text-secondary opacity-40",children:[v," d"]}),e[49]=v,e[50]=C):C=e[50];let q;e[51]!==le||e[52]!==C?(q=s.jsx(j,{title:"Days this year",subtitle:le,children:C}),e[51]=le,e[52]=C,e[53]=q):q=e[53];let B;e[54]===Symbol.for("react.memo_cache_sentinel")?(B=s.jsx(j,{title:"Days passed",subtitle:`${_} days passed`,children:s.jsxs("span",{className:"-mb-1 pt-1.5 stat-value max-sm:text-2xl text-accent",children:[_," d"]})}),e[54]=B):B=e[54];const oe=100-g;let U;e[55]!==oe?(U=oe.toFixed(2),e[55]=oe,e[56]=U):U=e[56];const ce=`${U}% remaining`;let R;e[57]!==g?(R=g.toFixed(2),e[57]=g,e[58]=R):R=e[58];let V;e[59]!==R?(V=s.jsxs("span",{className:"-mb-1 pt-1.5 stat-value max-sm:text-2xl text-accent",children:[R," %"]}),e[59]=R,e[60]=V):V=e[60];let A;e[61]!==ce||e[62]!==V?(A=s.jsx(j,{title:"Days completed",subtitle:ce,children:V}),e[61]=ce,e[62]=V,e[63]=A):A=e[63];const de=100-g;let J;e[64]!==de?(J=de.toFixed(2),e[64]=de,e[65]=J):J=e[65];const me=`${J}% remaining`;let I;e[66]!==g?(I=s.jsx("progress",{className:"progress progress-primary mb-3 mt-2 h-3.5",value:g,max:"100",role:"progressbar"}),e[66]=g,e[67]=I):I=e[67];let Q;e[68]!==me||e[69]!==I?(Q=s.jsx(j,{title:"Days progress",subtitle:me,children:I}),e[68]=me,e[69]=I,e[70]=Q):Q=e[70];let z;e[71]!==q||e[72]!==A||e[73]!==Q?(z=s.jsx(Z,{title:"Year progession",children:s.jsxs(fe,{children:[q,B,A,Q]})}),e[71]=q,e[72]=A,e[73]=Q,e[74]=z):z=e[74];let G;e[75]!==h.month_gaps||e[76]!==h.vacation_data||e[77]!==h.year_offset?(G=s.jsx(Z,{title:"Team Vacation",children:s.jsx(Se,{yearOffset:h.year_offset,gaps:h.month_gaps,data:h.vacation_data})}),e[75]=h.month_gaps,e[76]=h.vacation_data,e[77]=h.year_offset,e[78]=G):G=e[78];let X;return e[79]!==O||e[80]!==Y||e[81]!==z||e[82]!==G||e[83]!==w?(X=s.jsxs("div",{className:"flex flex-col container mx-auto justify-center align-middle gap-6 p-4",children:[w,O,Y,z,G]}),e[79]=O,e[80]=Y,e[81]=z,e[82]=G,e[83]=w,e[84]=X):X=e[84],X}function Ce(e){return e.isError}function qe(e){return e.isPending}export{Ie as component};
