import{j as s,c as ve,g as He,R as Qe,b as Ke,e as he,r as Ve,E as ze,T as Ge}from"./index-BPqVQIpi.js";import{L as Le,a as Me}from"./LoadingSpinner-CKTAvnNb.js";import{d as Ie}from"./dayjs.min-DdnWXo6l.js";function ye({children:e}){return s.jsx("div",{className:"stats bg-base-100 max-lg:stats-vertical grid grid-cols-2 grid-rows-2 lg:grid-rows-1 lg:grid-cols-4 w-full",children:e&&(Array.isArray(e)?s.jsxs(s.Fragment,{children:[...e]}):s.jsx(s.Fragment,{children:e}))})}function v(e){const t=ve.c(14),{title:i,stat:o,statClassName:h,subtitle:p,skeleton:j,children:a}=e,f=h===void 0?"-mb-1 pt-1.5 stat-value max-sm:text-2xl text-primary":h,x=`stat ${(j===void 0?!1:j)&&"skeleton"}`;let c;t[0]===Symbol.for("react.memo_cache_sentinel")?(c=s.jsx("div",{className:"stat-figure"}),t[0]=c):c=t[0];let l;t[1]!==i?(l=s.jsx("div",{className:"stat-title truncate text-accent/75 text-base ",children:i}),t[1]=i,t[2]=l):l=t[2];let m;t[3]!==a||t[4]!==o||t[5]!==f?(m=a?s.jsx(s.Fragment,{children:a}):s.jsx("div",{className:f,children:o}),t[3]=a,t[4]=o,t[5]=f,t[6]=m):m=t[6];let u;t[7]!==p?(u=s.jsx("div",{className:"stat-desc text-accent/30",children:p}),t[7]=p,t[8]=u):u=t[8];let y;return t[9]!==x||t[10]!==l||t[11]!==m||t[12]!==u?(y=s.jsxs("div",{className:x,children:[c,l,m,u]}),t[9]=x,t[10]=l,t[11]=m,t[12]=u,t[13]=y):y=t[13],y}function se({children:e,title:t}){return s.jsxs("div",{className:"overflow-hidden my-4 p-3 rounded-xl flex flex-col items-left justify-center",children:[s.jsx("h1",{className:"text-xl",children:t}),s.jsx("div",{className:"border-b border-primary/25 mt-2 mb-8"}),e&&(Array.isArray(e)?s.jsxs("div",{children:[...e]}):s.jsx("div",{children:e}))]})}var ge={exports:{}},Be=ge.exports,Ae;function Ue(){return Ae||(Ae=1,(function(e,t){(function(i,o){e.exports=o()})(Be,(function(){var i="day";return function(o,h,p){var j=function(n){return n.add(4-n.isoWeekday(),i)},a=h.prototype;a.isoWeekYear=function(){return j(this).year()},a.isoWeek=function(n){if(!this.$utils().u(n))return this.add(7*(n-this.isoWeek()),i);var x,c,l,m,u=j(this),y=(x=this.isoWeekYear(),c=this.$u,l=(c?p.utc:p)().year(x).startOf("year"),m=4-l.isoWeekday(),l.isoWeekday()>4&&(m+=7),l.add(m,i));return u.diff(y,"week")+1},a.isoWeekday=function(n){return this.$utils().u(n)?this.day()||7:this.day(this.day()%7?n:n-7)};var f=a.startOf;a.startOf=function(n,x){var c=this.$utils(),l=!!c.u(x)||x;return c.p(n)==="isoweek"?l?this.date(this.date()-(this.isoWeekday()-1)).startOf("day"):this.date(this.date()-1-(this.isoWeekday()-1)+7).endOf("day"):f.bind(this)(n,x)}}}))})(ge)),ge.exports}var Je=Ue();const Xe=He(Je);function Ze(e,t,i){return e<t?t:e>i?i:e}Ie.extend(Xe);function et(e){const t=ve.c(22),{day:i}=e;let o;t[0]===Symbol.for("react.memo_cache_sentinel")?(o=["#313745","#a7f3d0","#6ee7b7","#34d399","#10b981","#059669","#047857","#065f46","#064e3b"],t[0]=o):o=t[0];const h=o;let p;t[1]!==i.count||t[2]!==i.is_holiday?(p=i.is_holiday?"#7C85FF":h[Ze(i.count,0,8)],t[1]=i.count,t[2]=i.is_holiday,t[3]=p):p=t[3];const j=p;let a;t[4]!==i.date?(a=s.jsx("div",{children:i.date}),t[4]=i.date,t[5]=a):a=t[5];let f;t[6]!==i.count?(f=s.jsxs("div",{children:["Count: ",i.count]}),t[6]=i.count,t[7]=f):f=t[7];let n;t[8]!==i.usernames?(n=i.usernames?.map(tt),t[8]=i.usernames,t[9]=n):n=t[9];let x;t[10]!==n?(x=s.jsx(s.Fragment,{children:n}),t[10]=n,t[11]=x):x=t[11];let c;t[12]!==a||t[13]!==f||t[14]!==x?(c=s.jsxs("div",{className:"tooltip-content",children:[a,f,x]}),t[12]=a,t[13]=f,t[14]=x,t[15]=c):c=t[15];let l;t[16]!==j||t[17]!==i.last_day_of_month?(l=s.jsx("div",{className:"w-4 h-4 rounded-full",style:i.last_day_of_month?{boxShadow:"0 1.5rem 0 -0.25rem white",backgroundColor:j}:{backgroundColor:j}}),t[16]=j,t[17]=i.last_day_of_month,t[18]=l):l=t[18];let m;return t[19]!==c||t[20]!==l?(m=s.jsxs("div",{className:"tooltip",children:[c,l]}),t[19]=c,t[20]=l,t[21]=m):m=t[21],m}function tt(e,t){return s.jsx("p",{children:e},t)}function st(e){const t=ve.c(24),{gaps:i,yearOffset:o,data:h}=e;let p;t[0]===Symbol.for("react.memo_cache_sentinel")?(p=Ie().isoWeek(),t[0]=p):p=t[0];const j=p;let a=1,f;if(t[1]!==i||t[2]!==a){f=[];for(const b of i){f.push(a);for(let w=0;w<b;w++)a++,f.push(a);a++}t[1]=i,t[2]=a,t[3]=f}else f=t[3];const n=f;let x;t[4]===Symbol.for("react.memo_cache_sentinel")?(x=s.jsx("div",{className:"col-span-1"}),t[4]=x):x=t[4];let c;t[5]!==i?(c=i.map(nt),t[5]=i,t[6]=c):c=t[6];let l;t[7]!==c?(l=s.jsx("div",{className:"col-span-11 grid grid-rows-1 grid-flow-col h-10 gap-1 text-secondary/70",children:c}),t[7]=c,t[8]=l):l=t[8];let m;t[9]===Symbol.for("react.memo_cache_sentinel")?(m=s.jsx("div",{className:"col-span-1"}),t[9]=m):m=t[9];let u;t[10]!==n?(u=s.jsx("div",{className:"col-span-11 grid grid-rows-1 grid-flow-col h-10 gap-1 text-sm text-base-content/40",children:n.map(b=>s.jsx("p",{className:`w-4 h-4 text-center ${j===b?"text-primary font-bold":"font-light text-secondary/60"}`,children:b},b))}),t[10]=n,t[11]=u):u=t[11];let y;t[12]===Symbol.for("react.memo_cache_sentinel")?(y=s.jsxs("div",{className:"col-span-1 grid grid-rows-7 text-secondary/60 text-sm",children:[s.jsx("p",{className:"truncate",children:"Montag"}),s.jsx("p",{className:"truncate",children:"Dienstag"}),s.jsx("p",{className:"truncate",children:"Mittwoch"}),s.jsx("p",{className:"truncate",children:"Donnerstag"}),s.jsx("p",{className:"truncate",children:"Freitag"}),s.jsx("p",{className:"opacity-50 truncate",children:"Samstag"}),s.jsx("p",{className:"opacity-50 truncate",children:"Sonntag"})]}),t[12]=y):y=t[12];let r;t[13]!==o?(r=Array.from({length:o}).map(it),t[13]=o,t[14]=r):r=t[14];let g;t[15]!==h?(g=h.map(at),t[15]=h,t[16]=g):g=t[16];let d;t[17]!==r||t[18]!==g?(d=s.jsx("div",{className:"col-span-11 grid grid-rows-7 h-80 grid-flow-col gap-1",children:s.jsxs("div",{className:"contents",children:[r,g]})}),t[17]=r,t[18]=g,t[19]=d):d=t[19];let _;return t[20]!==d||t[21]!==l||t[22]!==u?(_=s.jsxs("div",{className:"grid grid-cols-12 p-5 bg-base-100 rounded-2xl  xl:overflow-x-hidden overflow-x-auto mb-12",children:[x,l,m,u,y,d]}),t[20]=d,t[21]=l,t[22]=u,t[23]=_):_=t[23],_}function at(e,t){return s.jsx(et,{day:e},t)}function it(e,t){return s.jsx("p",{},`yo-${t}`)}function nt(e,t){return s.jsxs("div",{className:"contents",children:[s.jsxs("p",{className:"h-4 w-4 text-center",children:[t+1,"."]}),Array.from({length:e}).map((i,o)=>s.jsx("p",{className:"w-4 h-4 -z-10"},`top-gap-${t}-${o}`))]},`top-${t}`)}function rt(e){return e%4===0&&e%100>0||e%400==0?366:365}function lt(){var e=new Date,t=new Date(e.getFullYear(),0,0),i=e-t+(t.getTimezoneOffset()-e.getTimezoneOffset())*60*1e3,o=1e3*60*60*24,h=Math.floor(i/o);return h}function ft(){const e=ve.c(122),{chrono:t,auth:i}=Qe.useRouteContext(),o=new Date().getFullYear(),{addErrorToast:h}=Ke(),p=he({queryKey:["user",i.userId,"vacation",o],queryFn:()=>t.users.getUserById(i.userId,{year:o}),staleTime:216e5,gcTime:252e5,retry:!1}),j=he({queryKey:["vacationGraph"],queryFn:()=>t.events.getVacationGraph(o),staleTime:6e4,gcTime:18e5,retry:!1}),a=he({queryKey:["awork",o],queryFn:()=>t.awork.getWorkTimesforYear(o),staleTime:36e5,gcTime:72e5,retry:!1}),f=he({queryKey:["timestamps","worked",o],queryFn:()=>t.timestamps.getWorkHours(o),staleTime:36e5,gcTime:72e5,retry:!1}),[n,x]=Ve.useState(),c=[p,j,f],l=c.some(ct),m=c.find(ot)?.error;let u;e[0]!==h||e[1]!==a.data||e[2]!==a.error||e[3]!==a.isError||e[4]!==a.isPending?(u=()=>{if(a.isError){h(a.error);return}a.isPending||x(a.data)},e[0]=h,e[1]=a.data,e[2]=a.error,e[3]=a.isError,e[4]=a.isPending,e[5]=u):u=e[5];let y;if(e[6]!==a.data||e[7]!==a.isError||e[8]!==a.isPending?(y=[a.isError,a.isPending,a.data],e[6]=a.data,e[7]=a.isError,e[8]=a.isPending,e[9]=y):y=e[9],Ve.useEffect(u,y),l){let k;return e[10]===Symbol.for("react.memo_cache_sentinel")?(k=s.jsx(Me,{}),e[10]=k):k=e[10],k}if(m){let k;return e[11]!==m?(k=s.jsx(ze,{error:m}),e[11]=m,e[12]=k):k=e[12],k}const r=p.data,g=j.data,d=f.data,_=rt(o),b=lt(),w=r.vacation_remaining/r.vacation_days*100,N=b/_*100,je=r.vacation_remaining>r.vacation_days?r.vacation_used/(r.vacation_used+r.vacation_remaining)*100:100-w,ae=n?n.expected-n.worked:0;let ie;e[13]===Symbol.for("react.memo_cache_sentinel")?(ie=s.jsx("span",{className:"animate-pulse font-medium text-white pr-1",children:" Hej "}),e[13]=ie):ie=e[13];const _e=r?.username;let $;e[14]!==_e?($=s.jsxs("div",{className:"text-[48px] pl-2 text-primary font-light mb-2",children:[ie,_e]}),e[14]=_e,e[15]=$):$=e[15];let ne;e[16]===Symbol.for("react.memo_cache_sentinel")?(ne=s.jsx(se,{title:"Timestamps",children:s.jsx(Ge,{})}),e[16]=ne):ne=e[16];const be=d.expected-d.worked;let re;e[17]!==be?(re=be.toFixed(2),e[17]=be,e[18]=re):re=e[18];const ke=`${re} h ${d.expected-d.worked>0?"remaining":"over"}`;let F;e[19]!==d.worked?(F=d.worked.toFixed(2),e[19]=d.worked,e[20]=F):F=e[20];let W;e[21]!==F?(W=s.jsxs("span",{className:"-mb-1 pt-1.5 stat-value max-sm:text-2xl text-primary",children:[F," h"]}),e[21]=F,e[22]=W):W=e[22];let E;e[23]!==W||e[24]!==ke?(E=s.jsx(v,{title:"Work done this year",subtitle:ke,children:W}),e[23]=W,e[24]=ke,e[25]=E):E=e[25];const Ne=d.expected/8;let le;e[26]!==Ne?(le=Ne.toFixed(2),e[26]=Ne,e[27]=le):le=e[27];const we=`${le} days`;let S;e[28]!==d.expected?(S=s.jsxs("span",{className:"-mb-1 pt-1.5 stat-value max-sm:text-2xl text-accent",children:[d.expected," h"]}),e[28]=d.expected,e[29]=S):S=e[29];let T;e[30]!==we||e[31]!==S?(T=s.jsx(v,{title:"Expected work",subtitle:we,children:S}),e[30]=we,e[31]=S,e[32]=T):T=e[32];const $e=d.vacation/8;let oe;e[33]!==$e?(oe=$e.toFixed(2),e[33]=$e,e[34]=oe):oe=e[34];const Fe=`${oe} days`;let P;e[35]!==d.vacation?(P=s.jsxs("span",{className:"-mb-1 pt-1.5 stat-value max-sm:text-2xl text-secondary opacity-40",children:[d.vacation," h"]}),e[35]=d.vacation,e[36]=P):P=e[36];let D;e[37]!==Fe||e[38]!==P?(D=s.jsx(v,{title:"Vacation taken",subtitle:Fe,children:P}),e[37]=Fe,e[38]=P,e[39]=D):D=e[39];const We=d.holidays/8;let ce;e[40]!==We?(ce=We.toFixed(2),e[40]=We,e[41]=ce):ce=e[41];const Ee=`${ce} days`;let q;e[42]!==d.holidays?(q=s.jsxs("span",{className:"-mb-1 pt-1.5 stat-value max-sm:text-2xl text-secondary opacity-40",children:[d.holidays," h"]}),e[42]=d.holidays,e[43]=q):q=e[43];let O;e[44]!==Ee||e[45]!==q?(O=s.jsx(v,{title:"Holidays",subtitle:Ee,children:q}),e[44]=Ee,e[45]=q,e[46]=O):O=e[46];let Y;e[47]!==E||e[48]!==T||e[49]!==D||e[50]!==O?(Y=s.jsx(se,{title:"Your worktimes",children:s.jsxs(ye,{children:[E,T,D,O]})}),e[47]=E,e[48]=T,e[49]=D,e[50]=O,e[51]=Y):Y=e[51];let C;e[52]!==n||e[53]!==a.isPending||e[54]!==ae?(C=s.jsx(se,{title:"Awork",children:a.isPending?s.jsx("div",{className:"skeleton h-30 flex justify-center w-full",children:s.jsx(Le,{})}):s.jsx(s.Fragment,{children:n&&s.jsx(s.Fragment,{children:s.jsxs(ye,{children:[s.jsx(v,{title:"Work done this year",subtitle:`${ae.toFixed(2)} h ${ae>0?"remaining":"over"}`,children:s.jsxs("span",{className:"-mb-1 pt-1.5 stat-value max-sm:text-2xl text-primary",children:[n.worked.toFixed(2)," h"]})}),s.jsx(v,{title:"Expected work",subtitle:`${(n.expected/8).toFixed(2)} days`,children:s.jsxs("span",{className:"-mb-1 pt-1.5 stat-value max-sm:text-2xl text-accent",children:[n.expected," h"]})}),s.jsx(v,{title:"Vacation taken",subtitle:`${(n.vacation/8).toFixed(2)} days`,children:s.jsxs("span",{className:"-mb-1 pt-1.5 stat-value max-sm:text-2xl text-secondary opacity-40",children:[n.vacation," h"]})}),s.jsx(v,{title:"Holidays",subtitle:`${(n.holidays/8).toFixed(2)} days`,children:s.jsxs("span",{className:"-mb-1 pt-1.5 stat-value max-sm:text-2xl text-secondary opacity-40",children:[n.holidays," h"]})})]})})})}),e[52]=n,e[53]=a.isPending,e[54]=ae,e[55]=C):C=e[55];let de;e[56]!==w?(de=w.toFixed(2),e[56]=w,e[57]=de):de=e[57];const Se=`${de}% remaining`;let R;e[58]!==r.vacation_remaining?(R=s.jsxs("span",{className:"-mb-1 pt-1.5 stat-value max-sm:text-2xl text-primary",children:[r.vacation_remaining," d"]}),e[58]=r.vacation_remaining,e[59]=R):R=e[59];let V;e[60]!==Se||e[61]!==R?(V=s.jsx(v,{title:"Vacation remaining",subtitle:Se,children:R}),e[60]=Se,e[61]=R,e[62]=V):V=e[62];let me;e[63]!==je?(me=je.toFixed(2),e[63]=je,e[64]=me):me=e[64];const Te=`${me}% taken`;let A;e[65]!==r.vacation_used?(A=s.jsxs("span",{className:"-mb-1 pt-1.5 stat-value max-sm:text-2xl text-secondary opacity-40",children:[r.vacation_used," d"]}),e[65]=r.vacation_used,e[66]=A):A=e[66];let I;e[67]!==Te||e[68]!==A?(I=s.jsx(v,{title:"Vacation taken",subtitle:Te,children:A}),e[67]=Te,e[68]=A,e[69]=I):I=e[69];const Pe=`${r.vacation_days} days total`;let H;e[70]!==r.vacation_days?(H=s.jsxs("span",{className:"-mb-1 pt-1.5 stat-value max-sm:text-2xl text-secondary opacity-40",children:[r.vacation_days," d"]}),e[70]=r.vacation_days,e[71]=H):H=e[71];let Q;e[72]!==Pe||e[73]!==H?(Q=s.jsx(v,{title:"Vacation total",subtitle:Pe,children:H}),e[72]=Pe,e[73]=H,e[74]=Q):Q=e[74];const De=`${r.pending_events} event${r.pending_events>1?"s":""} pending`;let K;e[75]!==r.pending_events?(K=s.jsxs("span",{className:"-mb-1 pt-1.5 stat-value max-sm:text-2xl text-accent",children:[s.jsx("span",{className:"animate-pulse text-primary",children:r.pending_events})," ","d"]}),e[75]=r.pending_events,e[76]=K):K=e[76];let z;e[77]!==De||e[78]!==K?(z=s.jsx(v,{title:"Vacation pending",subtitle:De,children:K}),e[77]=De,e[78]=K,e[79]=z):z=e[79];let G;e[80]!==V||e[81]!==I||e[82]!==Q||e[83]!==z?(G=s.jsx(se,{title:"Your vacation",children:s.jsxs(ye,{children:[V,I,Q,z]})}),e[80]=V,e[81]=I,e[82]=Q,e[83]=z,e[84]=G):G=e[84];const qe=`${_} days total`;let L;e[85]!==_?(L=s.jsxs("span",{className:"-mb-1 pt-1.5 stat-value max-sm:text-2xl text-secondary opacity-40",children:[_," d"]}),e[85]=_,e[86]=L):L=e[86];let M;e[87]!==qe||e[88]!==L?(M=s.jsx(v,{title:"Days this year",subtitle:qe,children:L}),e[87]=qe,e[88]=L,e[89]=M):M=e[89];let xe;e[90]===Symbol.for("react.memo_cache_sentinel")?(xe=s.jsx(v,{title:"Days passed",subtitle:`${b} days passed`,children:s.jsxs("span",{className:"-mb-1 pt-1.5 stat-value max-sm:text-2xl text-accent",children:[b," d"]})}),e[90]=xe):xe=e[90];const Oe=100-N;let fe;e[91]!==Oe?(fe=Oe.toFixed(2),e[91]=Oe,e[92]=fe):fe=e[92];const Ye=`${fe}% remaining`;let B;e[93]!==N?(B=N.toFixed(2),e[93]=N,e[94]=B):B=e[94];let U;e[95]!==B?(U=s.jsxs("span",{className:"-mb-1 pt-1.5 stat-value max-sm:text-2xl text-accent",children:[B," %"]}),e[95]=B,e[96]=U):U=e[96];let J;e[97]!==Ye||e[98]!==U?(J=s.jsx(v,{title:"Days completed",subtitle:Ye,children:U}),e[97]=Ye,e[98]=U,e[99]=J):J=e[99];const Ce=100-N;let ue;e[100]!==Ce?(ue=Ce.toFixed(2),e[100]=Ce,e[101]=ue):ue=e[101];const Re=`${ue}% remaining`;let X;e[102]!==N?(X=s.jsx("progress",{className:"progress progress-primary mb-3 mt-2 h-3.5",value:N,max:"100",role:"progressbar"}),e[102]=N,e[103]=X):X=e[103];let Z;e[104]!==Re||e[105]!==X?(Z=s.jsx(v,{title:"Days progress",subtitle:Re,children:X}),e[104]=Re,e[105]=X,e[106]=Z):Z=e[106];let ee;e[107]!==M||e[108]!==J||e[109]!==Z?(ee=s.jsx(se,{title:"Year progession",children:s.jsxs(ye,{children:[M,xe,J,Z]})}),e[107]=M,e[108]=J,e[109]=Z,e[110]=ee):ee=e[110];let te;e[111]!==g.month_gaps||e[112]!==g.vacation_data||e[113]!==g.year_offset?(te=s.jsx(se,{title:"Team Vacation",children:s.jsx(st,{yearOffset:g.year_offset,gaps:g.month_gaps,data:g.vacation_data})}),e[111]=g.month_gaps,e[112]=g.vacation_data,e[113]=g.year_offset,e[114]=te):te=e[114];let pe;return e[115]!==Y||e[116]!==C||e[117]!==$||e[118]!==G||e[119]!==ee||e[120]!==te?(pe=s.jsxs("div",{className:"flex flex-col container mx-auto justify-center align-middle gap-6 p-4",children:[$,ne,Y,C,G,ee,te]}),e[115]=Y,e[116]=C,e[117]=$,e[118]=G,e[119]=ee,e[120]=te,e[121]=pe):pe=e[121],pe}function ot(e){return e.isError}function ct(e){return e.isPending}export{ft as component};
