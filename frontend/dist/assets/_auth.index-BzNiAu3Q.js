import{j as s,c as J,g as me,R as xe,b as ue,e as re,r as oe,E as fe}from"./index-DZ392lUP.js";import{L as pe,a as he}from"./LoadingSpinner-CxlZY5L-.js";import{d as de}from"./dayjs.min-COto7ktL.js";function le({children:e}){return s.jsx("div",{className:"stats bg-base-100 max-lg:stats-vertical grid grid-cols-2 grid-rows-2 lg:grid-rows-1 lg:grid-cols-4 w-full",children:e&&(Array.isArray(e)?s.jsxs(s.Fragment,{children:[...e]}):s.jsx(s.Fragment,{children:e}))})}function j(e){const t=J.c(14),{title:i,stat:o,statClassName:p,subtitle:f,skeleton:y,children:a}=e,r=p===void 0?"-mb-1 pt-1.5 stat-value max-sm:text-2xl text-primary":p,m=`stat ${(y===void 0?!1:y)&&"skeleton"}`;let d;t[0]===Symbol.for("react.memo_cache_sentinel")?(d=s.jsx("div",{className:"stat-figure"}),t[0]=d):d=t[0];let l;t[1]!==i?(l=s.jsx("div",{className:"stat-title truncate text-accent/75 text-base ",children:i}),t[1]=i,t[2]=l):l=t[2];let x;t[3]!==a||t[4]!==o||t[5]!==r?(x=a?s.jsx(s.Fragment,{children:a}):s.jsx("div",{className:r,children:o}),t[3]=a,t[4]=o,t[5]=r,t[6]=x):x=t[6];let u;t[7]!==f?(u=s.jsx("div",{className:"stat-desc text-accent/30",children:f}),t[7]=f,t[8]=u):u=t[8];let n;return t[9]!==m||t[10]!==l||t[11]!==x||t[12]!==u?(n=s.jsxs("div",{className:m,children:[d,l,x,u]}),t[9]=m,t[10]=l,t[11]=x,t[12]=u,t[13]=n):n=t[13],n}function B({children:e,title:t}){return s.jsxs("div",{className:"overflow-hidden my-4 p-3 rounded-xl flex flex-col items-left justify-center",children:[s.jsx("h1",{className:"text-xl",children:t}),s.jsx("div",{className:"border-b border-primary/25 mt-2 mb-8"}),e&&(Array.isArray(e)?s.jsxs("div",{children:[...e]}):s.jsx("div",{children:e}))]})}var U={exports:{}},ye=U.exports,ce;function ge(){return ce||(ce=1,(function(e,t){(function(i,o){e.exports=o()})(ye,(function(){var i="day";return function(o,p,f){var y=function(c){return c.add(4-c.isoWeekday(),i)},a=p.prototype;a.isoWeekYear=function(){return y(this).year()},a.isoWeek=function(c){if(!this.$utils().u(c))return this.add(7*(c-this.isoWeek()),i);var m,d,l,x,u=y(this),n=(m=this.isoWeekYear(),d=this.$u,l=(d?f.utc:f)().year(m).startOf("year"),x=4-l.isoWeekday(),l.isoWeekday()>4&&(x+=7),l.add(x,i));return u.diff(n,"week")+1},a.isoWeekday=function(c){return this.$utils().u(c)?this.day()||7:this.day(this.day()%7?c:c-7)};var r=a.startOf;a.startOf=function(c,m){var d=this.$utils(),l=!!d.u(m)||m;return d.p(c)==="isoweek"?l?this.date(this.date()-(this.isoWeekday()-1)).startOf("day"):this.date(this.date()-1-(this.isoWeekday()-1)+7).endOf("day"):r.bind(this)(c,m)}}}))})(U)),U.exports}var ve=ge();const je=me(ve);function _e(e,t,i){return e<t?t:e>i?i:e}de.extend(je);function be(e){const t=J.c(22),{day:i}=e;let o;t[0]===Symbol.for("react.memo_cache_sentinel")?(o=["#313745","#a7f3d0","#6ee7b7","#34d399","#10b981","#059669","#047857","#065f46","#064e3b"],t[0]=o):o=t[0];const p=o;let f;t[1]!==i.count||t[2]!==i.is_holiday?(f=i.is_holiday?"#7C85FF":p[_e(i.count,0,8)],t[1]=i.count,t[2]=i.is_holiday,t[3]=f):f=t[3];const y=f;let a;t[4]!==i.date?(a=s.jsx("div",{children:i.date}),t[4]=i.date,t[5]=a):a=t[5];let r;t[6]!==i.count?(r=s.jsxs("div",{children:["Count: ",i.count]}),t[6]=i.count,t[7]=r):r=t[7];let c;t[8]!==i.usernames?(c=i.usernames?.map(Ne),t[8]=i.usernames,t[9]=c):c=t[9];let m;t[10]!==c?(m=s.jsx(s.Fragment,{children:c}),t[10]=c,t[11]=m):m=t[11];let d;t[12]!==a||t[13]!==r||t[14]!==m?(d=s.jsxs("div",{className:"tooltip-content",children:[a,r,m]}),t[12]=a,t[13]=r,t[14]=m,t[15]=d):d=t[15];let l;t[16]!==y||t[17]!==i.last_day_of_month?(l=s.jsx("div",{className:"w-4 h-4 rounded-full",style:i.last_day_of_month?{boxShadow:"0 1.5rem 0 -0.25rem white",backgroundColor:y}:{backgroundColor:y}}),t[16]=y,t[17]=i.last_day_of_month,t[18]=l):l=t[18];let x;return t[19]!==d||t[20]!==l?(x=s.jsxs("div",{className:"tooltip",children:[d,l]}),t[19]=d,t[20]=l,t[21]=x):x=t[21],x}function Ne(e,t){return s.jsx("p",{children:e},t)}function ke(e){const t=J.c(24),{gaps:i,yearOffset:o,data:p}=e;let f;t[0]===Symbol.for("react.memo_cache_sentinel")?(f=de().isoWeek(),t[0]=f):f=t[0];const y=f;let a=1,r;if(t[1]!==i||t[2]!==a){r=[];for(const g of i){r.push(a);for(let G=0;G<g;G++)a++,r.push(a);a++}t[1]=i,t[2]=a,t[3]=r}else r=t[3];const c=r;let m;t[4]===Symbol.for("react.memo_cache_sentinel")?(m=s.jsx("div",{className:"col-span-1"}),t[4]=m):m=t[4];let d;t[5]!==i?(d=i.map(Fe),t[5]=i,t[6]=d):d=t[6];let l;t[7]!==d?(l=s.jsx("div",{className:"col-span-11 grid grid-rows-1 grid-flow-col h-10 gap-1 text-secondary/70",children:d}),t[7]=d,t[8]=l):l=t[8];let x;t[9]===Symbol.for("react.memo_cache_sentinel")?(x=s.jsx("div",{className:"col-span-1"}),t[9]=x):x=t[9];let u;t[10]!==c?(u=s.jsx("div",{className:"col-span-11 grid grid-rows-1 grid-flow-col h-10 gap-1 text-sm text-base-content/40",children:c.map(g=>s.jsx("p",{className:`w-4 h-4 text-center ${y===g?"text-primary font-bold":"font-light text-secondary/60"}`,children:g},g))}),t[10]=c,t[11]=u):u=t[11];let n;t[12]===Symbol.for("react.memo_cache_sentinel")?(n=s.jsxs("div",{className:"col-span-1 grid grid-rows-7 text-secondary/60 text-sm",children:[s.jsx("p",{className:"truncate",children:"Montag"}),s.jsx("p",{className:"truncate",children:"Dienstag"}),s.jsx("p",{className:"truncate",children:"Mittwoch"}),s.jsx("p",{className:"truncate",children:"Donnerstag"}),s.jsx("p",{className:"truncate",children:"Freitag"}),s.jsx("p",{className:"opacity-50 truncate",children:"Samstag"}),s.jsx("p",{className:"opacity-50 truncate",children:"Sonntag"})]}),t[12]=n):n=t[12];let h;t[13]!==o?(h=Array.from({length:o}).map($e),t[13]=o,t[14]=h):h=t[14];let v;t[15]!==p?(v=p.map(we),t[15]=p,t[16]=v):v=t[16];let _;t[17]!==h||t[18]!==v?(_=s.jsx("div",{className:"col-span-11 grid grid-rows-7 h-80 grid-flow-col gap-1",children:s.jsxs("div",{className:"contents",children:[h,v]})}),t[17]=h,t[18]=v,t[19]=_):_=t[19];let N;return t[20]!==_||t[21]!==l||t[22]!==u?(N=s.jsxs("div",{className:"grid grid-cols-12 p-5 bg-base-100 rounded-2xl  xl:overflow-x-hidden overflow-x-auto mb-12",children:[m,l,x,u,n,_]}),t[20]=_,t[21]=l,t[22]=u,t[23]=N):N=t[23],N}function we(e,t){return s.jsx(be,{day:e},t)}function $e(e,t){return s.jsx("p",{},`yo-${t}`)}function Fe(e,t){return s.jsxs("div",{className:"contents",children:[s.jsxs("p",{className:"h-4 w-4 text-center",children:[t+1,"."]}),Array.from({length:e}).map((i,o)=>s.jsx("p",{className:"w-4 h-4 -z-10"},`top-gap-${t}-${o}`))]},`top-${t}`)}function We(e){return e%4===0&&e%100>0||e%400==0?366:365}function Ee(){var e=new Date,t=new Date(e.getFullYear(),0,0),i=e-t+(t.getTimezoneOffset()-e.getTimezoneOffset())*60*1e3,o=1e3*60*60*24,p=Math.floor(i/o);return p}function Ye(){const e=J.c(77),{chrono:t,auth:i}=xe.useRouteContext(),o=new Date().getFullYear(),{addErrorToast:p}=ue(),f=re({queryKey:["user",i.userId,"vacation",o],queryFn:()=>t.users.getUserById(i.userId,{year:o}),staleTime:216e5,gcTime:252e5}),y=re({queryKey:["vacationGraph"],queryFn:()=>t.events.getVacationGraph(o),staleTime:6e4,gcTime:18e5}),a=re({queryKey:["awork",o],queryFn:()=>t.awork.getWorkTimesforYear(o),staleTime:36e5,gcTime:72e5}),[r,c]=oe.useState(),m=[f,y],d=m.some(Pe),l=m.find(Se)?.error;let x;e[0]!==p||e[1]!==a.data||e[2]!==a.error||e[3]!==a.isError||e[4]!==a.isPending?(x=()=>{if(a.isError){p(a.error);return}a.isPending||c(a.data)},e[0]=p,e[1]=a.data,e[2]=a.error,e[3]=a.isError,e[4]=a.isPending,e[5]=x):x=e[5];let u;if(e[6]!==a.data||e[7]!==a.isError||e[8]!==a.isPending?(u=[a.isError,a.isPending,a.data],e[6]=a.data,e[7]=a.isError,e[8]=a.isPending,e[9]=u):u=e[9],oe.useEffect(x,u),d){let b;return e[10]===Symbol.for("react.memo_cache_sentinel")?(b=s.jsx(he,{}),e[10]=b):b=e[10],b}if(l){let b;return e[11]!==l?(b=s.jsx(fe,{error:l}),e[11]=l,e[12]=b):b=e[12],b}const n=f.data,h=y.data,v=We(o),_=Ee(),N=n.vacation_remaining/n.vacation_days*100,g=_/v*100,G=n.vacation_remaining>n.vacation_days?n.vacation_used/(n.vacation_used+n.vacation_remaining)*100:100-N,H=r?r.expected-r.worked:0;let K;e[13]===Symbol.for("react.memo_cache_sentinel")?(K=s.jsx("span",{className:"animate-pulse font-medium text-white pr-1",children:" Hej "}),e[13]=K):K=e[13];const X=n?.username;let k;e[14]!==X?(k=s.jsxs("div",{className:"text-[48px] pl-2 text-primary font-light mb-2",children:[K,X]}),e[14]=X,e[15]=k):k=e[15];const Z=`${N.toFixed(2)}% remaining`;let w;e[16]!==n.vacation_remaining?(w=s.jsxs("span",{className:"-mb-1 pt-1.5 stat-value max-sm:text-2xl text-primary",children:[n.vacation_remaining," d"]}),e[16]=n.vacation_remaining,e[17]=w):w=e[17];let $;e[18]!==Z||e[19]!==w?($=s.jsx(j,{title:"Vacation remaining",subtitle:Z,children:w}),e[18]=Z,e[19]=w,e[20]=$):$=e[20];const ee=`${G.toFixed(2)}% taken`;let F;e[21]!==n.vacation_used?(F=s.jsxs("span",{className:"-mb-1 pt-1.5 stat-value max-sm:text-2xl text-secondary opacity-40",children:[n.vacation_used," d"]}),e[21]=n.vacation_used,e[22]=F):F=e[22];let W;e[23]!==ee||e[24]!==F?(W=s.jsx(j,{title:"Vacation taken",subtitle:ee,children:F}),e[23]=ee,e[24]=F,e[25]=W):W=e[25];const te=`${n.vacation_days} days total`;let E;e[26]!==n.vacation_days?(E=s.jsxs("span",{className:"-mb-1 pt-1.5 stat-value max-sm:text-2xl text-secondary opacity-40",children:[n.vacation_days," d"]}),e[26]=n.vacation_days,e[27]=E):E=e[27];let S;e[28]!==te||e[29]!==E?(S=s.jsx(j,{title:"Vacation total",subtitle:te,children:E}),e[28]=te,e[29]=E,e[30]=S):S=e[30];const se=`${n.pending_events} event${n.pending_events>1?"s":""} pending`;let P;e[31]!==n.pending_events?(P=s.jsxs("span",{className:"-mb-1 pt-1.5 stat-value max-sm:text-2xl text-accent",children:[s.jsx("span",{className:"animate-pulse text-primary",children:n.pending_events})," ","d"]}),e[31]=n.pending_events,e[32]=P):P=e[32];let T;e[33]!==se||e[34]!==P?(T=s.jsx(j,{title:"Vacation pending",subtitle:se,children:P}),e[33]=se,e[34]=P,e[35]=T):T=e[35];let D;e[36]!==W||e[37]!==S||e[38]!==T||e[39]!==$?(D=s.jsx(B,{title:"Your vacation",children:s.jsxs(le,{children:[$,W,S,T]})}),e[36]=W,e[37]=S,e[38]=T,e[39]=$,e[40]=D):D=e[40];let O;e[41]!==r||e[42]!==a.isPending||e[43]!==H?(O=s.jsx(B,{title:"Your worktimes",children:a.isPending?s.jsx("div",{className:"skeleton h-30 flex justify-center w-full",children:s.jsx(pe,{})}):s.jsx(s.Fragment,{children:r&&s.jsx(s.Fragment,{children:s.jsxs(le,{children:[s.jsx(j,{title:"Work done this year",subtitle:`${H.toFixed(2)} h ${H>0?"remaining":"over"}`,children:s.jsxs("span",{className:"-mb-1 pt-1.5 stat-value max-sm:text-2xl text-primary",children:[r.worked.toFixed(2)," h"]})}),s.jsx(j,{title:"Expected work",subtitle:`${(r.expected/8).toFixed(2)} days`,children:s.jsxs("span",{className:"-mb-1 pt-1.5 stat-value max-sm:text-2xl text-accent",children:[r.expected," h"]})}),s.jsx(j,{title:"Vacation taken",subtitle:`${(r.vacation/8).toFixed(2)} days`,children:s.jsxs("span",{className:"-mb-1 pt-1.5 stat-value max-sm:text-2xl text-secondary opacity-40",children:[r.vacation," h"]})}),s.jsx(j,{title:"Holidays",subtitle:`${(r.holidays/8).toFixed(2)} days`,children:s.jsxs("span",{className:"-mb-1 pt-1.5 stat-value max-sm:text-2xl text-secondary opacity-40",children:[r.holidays," h"]})})]})})})}),e[41]=r,e[42]=a.isPending,e[43]=H,e[44]=O):O=e[44];const ae=`${v} days total`;let Y;e[45]!==v?(Y=s.jsxs("span",{className:"-mb-1 pt-1.5 stat-value max-sm:text-2xl text-secondary opacity-40",children:[v," d"]}),e[45]=v,e[46]=Y):Y=e[46];let C;e[47]!==ae||e[48]!==Y?(C=s.jsx(j,{title:"Days this year",subtitle:ae,children:Y}),e[47]=ae,e[48]=Y,e[49]=C):C=e[49];let L;e[50]===Symbol.for("react.memo_cache_sentinel")?(L=s.jsx(j,{title:"Days passed",subtitle:`${_} days passed`,children:s.jsxs("span",{className:"-mb-1 pt-1.5 stat-value max-sm:text-2xl text-accent",children:[_," d"]})}),e[50]=L):L=e[50];const ie=`${(100-g).toFixed(2)}% remaining`;let q;e[51]!==g?(q=g.toFixed(2),e[51]=g,e[52]=q):q=e[52];let R;e[53]!==q?(R=s.jsxs("span",{className:"-mb-1 pt-1.5 stat-value max-sm:text-2xl text-accent",children:[q," %"]}),e[53]=q,e[54]=R):R=e[54];let V;e[55]!==ie||e[56]!==R?(V=s.jsx(j,{title:"Days completed",subtitle:ie,children:R}),e[55]=ie,e[56]=R,e[57]=V):V=e[57];const ne=`${(100-g).toFixed(2)}% remaining`;let A;e[58]!==g?(A=s.jsx("progress",{className:"progress progress-primary mb-3 mt-2 h-3.5",value:g,max:"100",role:"progressbar"}),e[58]=g,e[59]=A):A=e[59];let I;e[60]!==ne||e[61]!==A?(I=s.jsx(j,{title:"Days progress",subtitle:ne,children:A}),e[60]=ne,e[61]=A,e[62]=I):I=e[62];let Q;e[63]!==C||e[64]!==V||e[65]!==I?(Q=s.jsx(B,{title:"Year progession",children:s.jsxs(le,{children:[C,L,V,I]})}),e[63]=C,e[64]=V,e[65]=I,e[66]=Q):Q=e[66];let z;e[67]!==h.month_gaps||e[68]!==h.vacation_data||e[69]!==h.year_offset?(z=s.jsx(B,{title:"Team Vacation",children:s.jsx(ke,{yearOffset:h.year_offset,gaps:h.month_gaps,data:h.vacation_data})}),e[67]=h.month_gaps,e[68]=h.vacation_data,e[69]=h.year_offset,e[70]=z):z=e[70];let M;return e[71]!==D||e[72]!==O||e[73]!==Q||e[74]!==z||e[75]!==k?(M=s.jsxs("div",{className:"flex flex-col container mx-auto justify-center align-middle gap-6 p-4",children:[k,D,O,Q,z]}),e[71]=D,e[72]=O,e[73]=Q,e[74]=z,e[75]=k,e[76]=M):M=e[76],M}function Se(e){return e.isError}function Pe(e){return e.isPending}export{Ye as component};
