import{c as V,l as Q,r as K,b as R,m as L,e as P,d as D,j as s,E as J}from"./index-Dphy0uOp.js";import{d as T}from"./dayjs.min-8lajkdaa.js";import{u as Y}from"./index.esm-DqJL4t5C.js";import{a as B}from"./LoadingSpinner-DQxibVNl.js";function W(){const e=V.c(47),{auth:n,chrono:a}=Q.useRouteContext(),[x,C]=K.useState(!1),{register:i,handleSubmit:w}=Y(),{addToast:E,addErrorToast:S}=R(),k=L();let d;e[0]!==n.userId?(d=["user",n.userId],e[0]=n.userId,e[1]=d):d=e[1];let o;e[2]!==n.userId||e[3]!==a?(o=()=>a.users.getUserById(n.userId),e[2]=n.userId,e[3]=a,e[4]=o):o=e[4];let h;e[5]!==d||e[6]!==o?(h={queryKey:d,queryFn:o,staleTime:216e5,gcTime:252e5,retry:!1},e[5]=d,e[6]=o,e[7]=h):h=e[7];const l=P(h);let j;e[8]===Symbol.for("react.memo_cache_sentinel")?(j=["aworkUsers"],e[8]=j):j=e[8];let f;e[9]!==a?(f={queryKey:j,queryFn:()=>a.awork.getUsers(),staleTime:216e5,gcTime:252e5,retry:!1},e[9]=a,e[10]=f):f=e[10];const I=P(f),F=l.data?.id;let c;e[11]!==F?(c=["profile",F],e[11]=F,e[12]=c):c=e[12];let u;e[13]!==a?(u=t=>{const{userId:U,data:A}=t;return a.users.updateUser(U,A)},e[13]=a,e[14]=u):u=e[14];let m;e[15]!==E||e[16]!==k?(m=()=>(E("Successfully updated profile settings","success"),C(!1),k.invalidateQueries({queryKey:["user"]})),e[15]=E,e[16]=k,e[17]=m):m=e[17];let p;e[18]!==S?(p=t=>S(t),e[18]=S,e[19]=p):p=e[19];let y;e[20]!==c||e[21]!==u||e[22]!==m||e[23]!==p?(y={mutationKey:c,mutationFn:u,onSuccess:m,onError:p,retry:!1},e[20]=c,e[21]=u,e[22]=m,e[23]=p,e[24]=y):y=e[24];const q=D(y);if(l.isPending){let t;return e[25]===Symbol.for("react.memo_cache_sentinel")?(t=s.jsx(B,{}),e[25]=t):t=e[25],t}if(l.isError){let t;return e[26]!==l.error?(t=s.jsx(J,{error:l.error}),e[26]=l.error,e[27]=t):t=e[27],t}const r=l.data;let b;e[28]!==r.created_at?(b=T(r.created_at).toString(),e[28]=r.created_at,e[29]=b):b=e[29];const g=b;let _;e[30]!==r.edited_at?(_=T(r.edited_at).toString(),e[30]=r.edited_at,e[31]=_):_=e[31];const v=_;let N;return e[32]!==I||e[33]!==g||e[34]!==x||e[35]!==v||e[36]!==w||e[37]!==q||e[38]!==i||e[39]!==r.awork_id||e[40]!==r.color||e[41]!==r.email||e[42]!==r.id||e[43]!==r.is_superuser||e[44]!==r.username||e[45]!==r.vacation_days?(N=s.jsx(s.Fragment,{children:x?s.jsx("div",{children:s.jsxs("form",{onSubmit:w(t=>q.mutate({userId:r.id,data:t})),children:[s.jsx("div",{className:"container justify-center flex",children:s.jsxs("div",{className:"space-y-2 bg-base-100 rounded-xl px-8 py-10",children:[s.jsx("h1",{className:"font-bold text-xl mb-0",children:"Profile"}),s.jsx("div",{className:"divider mb-4 mt-0"}),s.jsxs("div",{className:"grid gap-4 grid-cols-2",children:[s.jsx("label",{htmlFor:"username",children:"Username"}),s.jsx("input",{className:"input input-bordered",type:"text",required:!0,defaultValue:r.username,...i("username")}),s.jsx("label",{htmlFor:"email",children:"Email"}),s.jsx("input",{className:"input input-bordered",type:"email",required:!0,defaultValue:r.email,...i("email")}),s.jsx("label",{htmlFor:"awork_id",children:"Awork ID"}),s.jsxs("select",{defaultValue:r.awork_id||"",className:"w-full col-span-1 cursor-pointer p-2 select pl-3 text-center h-full  rounded-md ",...i("awork_id"),children:[s.jsx("option",{value:"",children:"-"}),I.data?.map($)]}),s.jsx("label",{htmlFor:"password",children:"New Password"}),s.jsx("input",{className:"input input-bordered",type:"password",...i("password")}),s.jsx("p",{children:"Admin"}),s.jsx("p",{children:String(r.is_superuser)}),s.jsx("p",{children:"Yearly Vacation"}),s.jsx("p",{children:r.vacation_days}),s.jsx("label",{htmlFor:"color",children:"Color"}),s.jsx("input",{className:"input input-bordered",type:"color",required:!0,defaultValue:r.color,...i("color")}),s.jsx("p",{children:"Joined"}),s.jsx("p",{children:g}),s.jsx("p",{children:"Last Edit"}),s.jsx("p",{children:v})]})]})}),s.jsx("div",{className:"container mx-auto max-w-lg px-6 mt-4",children:s.jsxs("button",{type:"submit",className:"btn btn-soft btn-primary animate-color",children:[s.jsx("span",{className:"icon-outlined pr-2",children:"save"}),"Save"]})})]})}):s.jsxs("div",{children:[s.jsx("div",{className:"container mx-auto max-w-lg px-6",children:s.jsxs("div",{className:"space-y-2 bg-base-100 rounded-xl px-8 py-10",children:[s.jsx("h1",{className:"font-bold text-xl mb-0",children:"Profile"}),s.jsx("div",{className:"divider mb-4 mt-0"}),s.jsxs("div",{className:"grid gap-4 grid-cols-2",children:[s.jsx("p",{children:"Username"}),s.jsx("p",{children:r.username}),s.jsx("p",{children:"Email"}),s.jsx("p",{children:r.email}),s.jsx("p",{children:"Awork ID"}),s.jsx("p",{children:r.awork_id}),s.jsx("p",{children:"Admin"}),s.jsx("p",{children:String(r.is_superuser)}),s.jsx("p",{children:"Yearly Vacation"}),s.jsx("p",{children:r.vacation_days}),s.jsx("p",{children:"Color"}),s.jsx("p",{className:"max-w-40 rounded-full ",style:{backgroundColor:r.color}}),s.jsx("p",{children:"Joined"}),s.jsx("p",{children:g}),s.jsx("p",{children:"Last Edit"}),s.jsx("p",{children:v})]})]})}),s.jsx("div",{className:"container mx-auto max-w-lg px-6 mt-4",children:s.jsxs("button",{onClick:()=>{C(M)},type:"submit",className:"btn btn-soft btn-primary animate-color",children:[s.jsx("span",{className:"icon-outlined pr-2",children:x?"save":"edit"}),x?"Save":"Edit"]})})]})}),e[32]=I,e[33]=g,e[34]=x,e[35]=v,e[36]=w,e[37]=q,e[38]=i,e[39]=r.awork_id,e[40]=r.color,e[41]=r.email,e[42]=r.id,e[43]=r.is_superuser,e[44]=r.username,e[45]=r.vacation_days,e[46]=N):N=e[46],N}function M(e){return!e}function $(e){return s.jsxs("option",{value:e.id,children:[e.firstName," ",e.lastName]},e.id)}export{W as component};
