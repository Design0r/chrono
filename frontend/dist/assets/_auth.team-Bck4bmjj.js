import{c as M,f as Y,e as H,j as r,r as L,b as J,d as O,h as W,i as $,k as X,E as Z}from"./index-BSHNpg02.js";import{a as ee}from"./LoadingSpinner-C7sRGP0z.js";function oe(){const t=M.c(34),{chrono:e,auth:s}=Y.useRouteContext();let v;t[0]===Symbol.for("react.memo_cache_sentinel")?(v=["users","vacation"],t[0]=v):v=t[0];let l;t[1]!==e?(l={queryKey:v,queryFn:()=>e.users.getUsers({year:new Date().getFullYear()}),staleTime:18e5,gcTime:36e5,retry:!1},t[1]=e,t[2]=l):l=t[2];const k=H(l);let n;t[3]!==s.userId?(n=["user",s.userId],t[3]=s.userId,t[4]=n):n=t[4];let j;t[5]!==s.userId||t[6]!==e?(j=()=>e.users.getUserById(s.userId),t[5]=s.userId,t[6]=e,t[7]=j):j=t[7];let _;t[8]!==n||t[9]!==j?(_={queryKey:n,queryFn:j,staleTime:216e5,gcTime:252e5,retry:!1},t[8]=n,t[9]=j,t[10]=_):_=t[10];const S=H(_),R=[k,S],z=R.some(se),N=R.find(te)?.error;if(z){let a;return t[11]===Symbol.for("react.memo_cache_sentinel")?(a=r.jsx(ee,{}),t[11]=a):a=t[11],a}if(N){let a;return t[12]!==N?(a=r.jsx(Z,{error:N}),t[12]=N,t[13]=a):a=t[13],a}const T=k.data,c=S.data;let I,d,u,m,h,g,C,x;t[14]===Symbol.for("react.memo_cache_sentinel")?(m=r.jsx("th",{children:"ID"}),h=r.jsx("th",{children:"Name"}),g=r.jsx("th",{className:"text-center",children:"Vacation Days"}),C=r.jsx("th",{className:"text-center",children:"Used"}),x=r.jsx("th",{className:"text-center",children:"Remaining"}),I=r.jsx("th",{children:"Email"}),d=r.jsx("th",{children:"Role"}),u=r.jsx("th",{children:"Enabled"}),t[14]=I,t[15]=d,t[16]=u,t[17]=m,t[18]=h,t[19]=g,t[20]=C,t[21]=x):(I=t[14],d=t[15],u=t[16],m=t[17],h=t[18],g=t[19],C=t[20],x=t[21]);let o;t[22]!==c?.is_superuser?(o=c?.is_superuser&&r.jsx(r.Fragment,{children:r.jsx("th",{})}),t[22]=c?.is_superuser,t[23]=o):o=t[23];let f;t[24]!==o?(f=r.jsx("thead",{children:r.jsxs("tr",{className:"text-base-content border-b-1.5 border-primary/65",children:[m,h,g,C,x,I,d,u,o]})}),t[24]=o,t[25]=f):f=t[25];let y;t[26]!==c||t[27]!==T?(y=c&&T.map((a,E)=>r.jsx(re,{user:a,currUser:c},E)),t[26]=c,t[27]=T,t[28]=y):y=t[28];let p;t[29]!==y?(p=r.jsx("tbody",{children:y}),t[29]=y,t[30]=p):p=t[30];let b;return t[31]!==f||t[32]!==p?(b=r.jsx("div",{className:"p-2 my-2",children:r.jsx("div",{className:"overflow-x-auto bg-info/3",children:r.jsxs("table",{className:"table table-zebra table-md",children:[f,p]})})}),t[31]=f,t[32]=p,t[33]=b):b=t[33],b}function te(t){return t.isError}function se(t){return t.isPending}function re(t){const e=M.c(69),{user:s,currUser:v}=t,[l,k]=L.useState(!1),{chrono:n,queryClient:j}=Y.useRouteContext(),{addToast:_,addErrorToast:S}=J(),[R,z]=L.useState(s.vacation_days),[N,T]=L.useState(s.role),[c,I]=L.useState(s.enabled);let d;e[0]!==s.id?(d=["user","update",s.id],e[0]=s.id,e[1]=d):d=e[1];let u;e[2]!==n?(u=i=>{const{userId:A,data:G}=i;return n.users.updateUser(A,G)},e[2]=n,e[3]=u):u=e[3];let m;e[4]!==_||e[5]!==j?(m=()=>(_("Successfully updated profile settings","success"),k(!1),j.invalidateQueries({queryKey:["users"]})),e[4]=_,e[5]=j,e[6]=m):m=e[6];let h;e[7]!==S?(h=i=>S(i),e[7]=S,e[8]=h):h=e[8];let g;e[9]!==d||e[10]!==u||e[11]!==m||e[12]!==h?(g={mutationKey:d,mutationFn:u,onSuccess:m,onError:h,retry:!1},e[9]=d,e[10]=u,e[11]=m,e[12]=h,e[13]=g):g=e[13];const C=O(g);let x,o,f;if(e[14]!==s){const i=W(s?s.color:"#000");o=$(...i,.6),x=$(...i,.2),f=$(...i,1),e[14]=s,e[15]=x,e[16]=o,e[17]=f}else x=e[15],o=e[16],f=e[17];const y=f,p=s.vacation_days>0?"hover:bg-primary/10 pt-8 border-b border-primary/25 text-base-content/80 hover:text-primary animate-color":"bg-error/35 hover:bg-error/50 pt-8 border-2 border-error/70 text-base-content/80 animate-color";let b;e[18]!==x||e[19]!==o?(b={backgroundColor:x,borderColor:o},e[18]=x,e[19]=o,e[20]=b):b=e[20];let a;e[21]!==y?(a={color:y},e[21]=y,e[22]=a):a=e[22];let E;e[23]!==a||e[24]!==s.id?(E=r.jsx("div",{className:"text-sm text-center",style:a,children:s.id}),e[23]=a,e[24]=s.id,e[25]=E):E=e[25];let q;e[26]!==E||e[27]!==b?(q=r.jsx("th",{children:r.jsx("div",{tabIndex:0,role:"button",className:"avatar placeholder p-0 ",children:r.jsx("div",{className:"w-8 flex items-center justify-center border rounded-full text-neutral-content",style:b,children:E})})}),e[26]=E,e[27]=b,e[28]=q):q=e[28];let F;e[29]!==s.username?(F=r.jsx("th",{children:s.username}),e[29]=s.username,e[30]=F):F=e[30];let U;e[31]!==l||e[32]!==s.vacation_days?(U=r.jsx("td",{className:"text-center",children:l?r.jsx("input",{className:"input input-bordered",type:"number",step:.5,required:!0,defaultValue:s.vacation_days,onChange:i=>z(Number(i.target.value))}):r.jsx(r.Fragment,{children:s.vacation_days})}),e[31]=l,e[32]=s.vacation_days,e[33]=U):U=e[33];let w;e[34]!==s.vacation_used?(w=r.jsx("td",{className:"text-center",children:s.vacation_used}),e[34]=s.vacation_used,e[35]=w):w=e[35];let D;e[36]!==s.vacation_remaining?(D=r.jsx("td",{className:"text-center",children:s.vacation_remaining}),e[36]=s.vacation_remaining,e[37]=D):D=e[37];let K;e[38]!==s.email?(K=r.jsx("td",{children:s.email}),e[38]=s.email,e[39]=K):K=e[39];let P;e[40]!==n||e[41]!==l||e[42]!==s.role?(P=r.jsx("td",{children:l?r.jsx("select",{required:!0,defaultValue:s.role,onChange:i=>T(i.target.value),children:n.users.getRoles().map(ae)}):r.jsx(r.Fragment,{children:s.role})}),e[40]=n,e[41]=l,e[42]=s.role,e[43]=P):P=e[43];let Q;e[44]!==l||e[45]!==s.enabled?(Q=r.jsx("td",{className:"icon-outlined",children:l?r.jsx("input",{type:"checkbox",className:"checkbox",onChange:i=>I(!!i.target.value),defaultChecked:s.enabled}):r.jsx("input",{type:"checkbox",className:"checkbox cursor-not-allowed",defaultChecked:s.enabled,contentEditable:!1})}),e[44]=l,e[45]=s.enabled,e[46]=Q):Q=e[46];let V;e[47]!==v.is_superuser||e[48]!==l||e[49]!==c||e[50]!==C||e[51]!==N||e[52]!==s.enabled||e[53]!==s.id||e[54]!==s.role||e[55]!==s.vacation_days||e[56]!==R?(V=v.is_superuser&&r.jsx("td",{children:l?r.jsxs(r.Fragment,{children:[r.jsx("button",{onClick:()=>{C.mutate({userId:s.id,data:{vacation_days:R,enabled:c,role:N}}),k(!1)},className:"btn btn-soft btn-success animate-color icon-outlined",children:"check"}),r.jsx("button",{onClick:()=>{k(!1),T(s.role),z(s.vacation_days),I(s.enabled)},className:"btn btn-soft btn-error animate-color icon-outlined",children:"close"})]}):r.jsx("button",{onClick:()=>k(!0),className:"btn btn-soft btn-ghost animate-color icon-outlined",children:"edit"})}),e[47]=v.is_superuser,e[48]=l,e[49]=c,e[50]=C,e[51]=N,e[52]=s.enabled,e[53]=s.id,e[54]=s.role,e[55]=s.vacation_days,e[56]=R,e[57]=V):V=e[57];let B;return e[58]!==q||e[59]!==F||e[60]!==U||e[61]!==w||e[62]!==D||e[63]!==K||e[64]!==P||e[65]!==Q||e[66]!==V||e[67]!==p?(B=r.jsxs("tr",{className:p,children:[q,F,U,w,D,K,P,Q,V]}),e[58]=q,e[59]=F,e[60]=U,e[61]=w,e[62]=D,e[63]=K,e[64]=P,e[65]=Q,e[66]=V,e[67]=p,e[68]=B):B=e[68],B}function ae(t,e){return r.jsx("option",{value:t,children:X(t)},e)}export{oe as component};
