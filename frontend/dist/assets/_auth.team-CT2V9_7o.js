import{c as Y,f as A,e as M,j as r,r as $,b as O,d as W,h as X,i as H,k as Z,E as ee}from"./index-DZ392lUP.js";import{a as te}from"./LoadingSpinner-CxlZY5L-.js";function ie(){const t=Y.c(34),{chrono:e,auth:s}=A.useRouteContext();let y;t[0]===Symbol.for("react.memo_cache_sentinel")?(y=["users","vacation"],t[0]=y):y=t[0];let l;t[1]!==e?(l={queryKey:y,queryFn:()=>e.users.getUsers({year:new Date().getFullYear()}),staleTime:18e5,gcTime:36e5},t[1]=e,t[2]=l):l=t[2];const k=M(l);let n;t[3]!==s.userId?(n=["user",s.userId],t[3]=s.userId,t[4]=n):n=t[4];let b;t[5]!==s.userId||t[6]!==e?(b=()=>e.users.getUserById(s.userId),t[5]=s.userId,t[6]=e,t[7]=b):b=t[7];let g;t[8]!==n||t[9]!==b?(g={queryKey:n,queryFn:b,staleTime:216e5,gcTime:252e5},t[8]=n,t[9]=b,t[10]=g):g=t[10];const S=M(g),R=[k,S],B=R.some(re),v=R.find(se)?.error;if(B){let a;return t[11]===Symbol.for("react.memo_cache_sentinel")?(a=r.jsx(te,{}),t[11]=a):a=t[11],a}if(v){let a;return t[12]!==v?(a=r.jsx(ee,{error:v}),t[12]=v,t[13]=a):a=t[13],a}const T=k.data,d=S.data;let I,u,m,h,x,p,_,N;t[14]===Symbol.for("react.memo_cache_sentinel")?(h=r.jsx("th",{children:"ID"}),x=r.jsx("th",{children:"Name"}),p=r.jsx("th",{className:"text-center",children:"Vacation Days"}),_=r.jsx("th",{className:"text-center",children:"Used"}),N=r.jsx("th",{className:"text-center",children:"Remaining"}),I=r.jsx("th",{children:"Email"}),u=r.jsx("th",{children:"Role"}),m=r.jsx("th",{children:"Enabled"}),t[14]=I,t[15]=u,t[16]=m,t[17]=h,t[18]=x,t[19]=p,t[20]=_,t[21]=N):(I=t[14],u=t[15],m=t[16],h=t[17],x=t[18],p=t[19],_=t[20],N=t[21]);let o;t[22]!==d?.is_superuser?(o=d?.is_superuser&&r.jsx(r.Fragment,{children:r.jsx("th",{})}),t[22]=d?.is_superuser,t[23]=o):o=t[23];let i;t[24]!==o?(i=r.jsx("thead",{children:r.jsxs("tr",{className:"text-base-content border-b-1.5 border-primary/65",children:[h,x,p,_,N,I,u,m,o]})}),t[24]=o,t[25]=i):i=t[25];let f;t[26]!==d||t[27]!==T?(f=d&&T.map((a,E)=>r.jsx(ae,{user:a,currUser:d},E)),t[26]=d,t[27]=T,t[28]=f):f=t[28];let j;t[29]!==f?(j=r.jsx("tbody",{children:f}),t[29]=f,t[30]=j):j=t[30];let C;return t[31]!==i||t[32]!==j?(C=r.jsx("div",{className:"p-2 my-2",children:r.jsx("div",{className:"overflow-x-auto bg-info/3",children:r.jsxs("table",{className:"table table-zebra table-md",children:[i,j]})})}),t[31]=i,t[32]=j,t[33]=C):C=t[33],C}function se(t){return t.isError}function re(t){return t.isPending}function ae(t){const e=Y.c(69),{user:s,currUser:y}=t,[l,k]=$.useState(!1),{chrono:n,queryClient:b}=A.useRouteContext(),{addToast:g,addErrorToast:S}=O(),[R,B]=$.useState(s.vacation_days),[v,T]=$.useState(s.role),[d,I]=$.useState(s.enabled);let u;e[0]!==s.id?(u=["user","update",s.id],e[0]=s.id,e[1]=u):u=e[1];let m;e[2]!==n?(m=c=>{const{userId:G,data:J}=c;return n.users.updateUser(G,J)},e[2]=n,e[3]=m):m=e[3];let h;e[4]!==g||e[5]!==b?(h=()=>(g("Successfully updated profile settings","success"),k(!1),b.invalidateQueries({queryKey:["users"]})),e[4]=g,e[5]=b,e[6]=h):h=e[6];let x;e[7]!==S?(x=c=>S(c),e[7]=S,e[8]=x):x=e[8];let p;e[9]!==u||e[10]!==m||e[11]!==h||e[12]!==x?(p={mutationKey:u,mutationFn:m,onSuccess:h,onError:x},e[9]=u,e[10]=m,e[11]=h,e[12]=x,e[13]=p):p=e[13];const _=W(p),N=s?s.color:"#000";let o,i,f;if(e[14]!==N){const c=X(N);i=H(...c,.6),o=H(...c,.2),f=H(...c,1),e[14]=N,e[15]=o,e[16]=i,e[17]=f}else o=e[15],i=e[16],f=e[17];const j=f,C=s.vacation_days>0?"hover:bg-primary/10 pt-8 border-b border-primary/25 text-base-content/80 hover:text-primary animate-color":"bg-error/35 hover:bg-error/50 pt-8 border-2 border-error/70 text-base-content/80 animate-color";let a;e[18]!==o||e[19]!==i?(a={backgroundColor:o,borderColor:i},e[18]=o,e[19]=i,e[20]=a):a=e[20];let E;e[21]!==j?(E={color:j},e[21]=j,e[22]=E):E=e[22];let q;e[23]!==E||e[24]!==s.id?(q=r.jsx("div",{className:"text-sm text-center",style:E,children:s.id}),e[23]=E,e[24]=s.id,e[25]=q):q=e[25];let F;e[26]!==q||e[27]!==a?(F=r.jsx("th",{children:r.jsx("div",{tabIndex:0,role:"button",className:"avatar placeholder p-0 ",children:r.jsx("div",{className:"w-8 flex items-center justify-center border rounded-full text-neutral-content",style:a,children:q})})}),e[26]=q,e[27]=a,e[28]=F):F=e[28];let U;e[29]!==s.username?(U=r.jsx("th",{children:s.username}),e[29]=s.username,e[30]=U):U=e[30];let w;e[31]!==l||e[32]!==s.vacation_days?(w=r.jsx("td",{className:"text-center",children:l?r.jsx("input",{className:"input input-bordered",type:"number",step:.5,required:!0,defaultValue:s.vacation_days,onChange:c=>B(Number(c.target.value))}):r.jsx(r.Fragment,{children:s.vacation_days})}),e[31]=l,e[32]=s.vacation_days,e[33]=w):w=e[33];let D;e[34]!==s.vacation_used?(D=r.jsx("td",{className:"text-center",children:s.vacation_used}),e[34]=s.vacation_used,e[35]=D):D=e[35];let K;e[36]!==s.vacation_remaining?(K=r.jsx("td",{className:"text-center",children:s.vacation_remaining}),e[36]=s.vacation_remaining,e[37]=K):K=e[37];let P;e[38]!==s.email?(P=r.jsx("td",{children:s.email}),e[38]=s.email,e[39]=P):P=e[39];let Q;e[40]!==n||e[41]!==l||e[42]!==s.role?(Q=r.jsx("td",{children:l?r.jsx("select",{required:!0,defaultValue:s.role,onChange:c=>T(c.target.value),children:n.users.getRoles().map(le)}):r.jsx(r.Fragment,{children:s.role})}),e[40]=n,e[41]=l,e[42]=s.role,e[43]=Q):Q=e[43];let V;e[44]!==l||e[45]!==s.enabled?(V=r.jsx("td",{className:"icon-outlined",children:l?r.jsx("input",{type:"checkbox",className:"checkbox",onChange:c=>I(!!c.target.value),defaultChecked:s.enabled}):r.jsx("input",{type:"checkbox",className:"checkbox cursor-not-allowed",defaultChecked:s.enabled,contentEditable:!1})}),e[44]=l,e[45]=s.enabled,e[46]=V):V=e[46];let z;e[47]!==y.is_superuser||e[48]!==l||e[49]!==d||e[50]!==_||e[51]!==v||e[52]!==s.enabled||e[53]!==s.id||e[54]!==s.role||e[55]!==s.vacation_days||e[56]!==R?(z=y.is_superuser&&r.jsx("td",{children:l?r.jsxs(r.Fragment,{children:[r.jsx("button",{onClick:()=>{_.mutate({userId:s.id,data:{vacation_days:R,enabled:d,role:v}}),k(!1)},className:"btn btn-soft btn-success animate-color icon-outlined",children:"check"}),r.jsx("button",{onClick:()=>{k(!1),T(s.role),B(s.vacation_days),I(s.enabled)},className:"btn btn-soft btn-error animate-color icon-outlined",children:"close"})]}):r.jsx("button",{onClick:()=>k(!0),className:"btn btn-soft btn-ghost animate-color icon-outlined",children:"edit"})}),e[47]=y.is_superuser,e[48]=l,e[49]=d,e[50]=_,e[51]=v,e[52]=s.enabled,e[53]=s.id,e[54]=s.role,e[55]=s.vacation_days,e[56]=R,e[57]=z):z=e[57];let L;return e[58]!==F||e[59]!==U||e[60]!==w||e[61]!==D||e[62]!==K||e[63]!==P||e[64]!==Q||e[65]!==V||e[66]!==z||e[67]!==C?(L=r.jsxs("tr",{className:C,children:[F,U,w,D,K,P,Q,V,z]}),e[58]=F,e[59]=U,e[60]=w,e[61]=D,e[62]=K,e[63]=P,e[64]=Q,e[65]=V,e[66]=z,e[67]=C,e[68]=L):L=e[68],L}function le(t,e){return r.jsx("option",{value:t,children:Z(t)},e)}export{ie as component};
